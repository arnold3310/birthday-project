<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy 21st Birthday</title>
    <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2.10.7/dist/index.umd.js"></script>
    <style>
        /* =========================================
           GLOBAL STYLES (å…¨åŸŸè¨­å®š - ä¸ç”¨å‹•)
           ========================================= */
        body {
            margin: 0; padding: 0; background-color: #000; color: #fff;
            font-family: 'Microsoft JhengHei', sans-serif;
            display: flex; justify-content: center; align-items: center; min-height: 100vh;
            overflow: hidden;
        }
        /* éš±è—æ‰€æœ‰å ´æ™¯ï¼Œåªæœ‰åŠ ä¸Š active æ‰æœƒé¡¯ç¤º */
        .scene-container { display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; justify-content: center; align-items: center; flex-direction: column; }
        .scene-container.active { display: flex; }
        
        /* èƒŒæ™¯ç…™ç«èˆ‡å½±ç‰‡ */
        #fireworks-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        #bg-video { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: cover; z-index: -1; filter: brightness(0.4); opacity: 0; transition: opacity 2s ease-in; }

        /* =========================================
           SCENE 1 STYLE: çµ‚ç«¯æ©Ÿç™»å…¥
           ========================================= */

        .s1_terminal {
            border: 1px solid #0f0; padding: 40px; width: 85%; max-width: 400px;
            background: rgba(0, 20, 0, 0.9); 
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2), inset 0 0 10px rgba(0, 255, 0, 0.1);
            font-family: 'Courier New', monospace; text-align: center; position: relative; z-index: 10;
            border-radius: 5px;
        }
        .s1_text { color: #0f0; font-size: 1rem; text-align: left; margin-bottom: 20px; min-height: 80px; text-shadow: 0 0 5px #0f0; line-height: 1.5; }
        .s1_input { background: transparent; border: none; border-bottom: 2px solid #0f0; color: #fff; font-size: 1.5rem; text-align: center; width: 80%; outline: none; margin-bottom: 25px; letter-spacing: 5px; }
        .s1_btn { background: #0f0; color: #000; border: none; padding: 12px 20px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; transition: 0.3s; }
        .s1_btn:hover { background: #fff; box-shadow: 0 0 20px #fff; }

        /* é€²åº¦æ¢æ¨£å¼ */
        .s1_loading_container { display: none; width: 100%; margin-top: 20px; text-align: left; }
        .s1_loading_bar_bg { width: 100%; height: 10px; background: rgba(0, 255, 0, 0.1); border: 1px solid #0f0; margin-top: 10px; position: relative; }
        .s1_loading_bar_fill { width: 0%; height: 100%; background: #0f0; box-shadow: 0 0 10px #0f0; transition: width 0.1s linear; }
        .s1_status { color: #0f0; font-size: 0.8rem; margin-top: 5px; }
        /* =========================================
           SCENE 2 STYLE: èµ°ä½æ¸¬è©¦ (æƒ¡ææŒ‰éˆ•)
           ========================================= */
        .s2_card { background: rgba(255,255,255,0.1); padding: 40px; border-radius: 20px; backdrop-filter: blur(10px); text-align: center; border: 1px solid rgba(255,255,255,0.2); z-index: 10; width: 300px; }
        .s2_btn_ok { padding: 10px 30px; background: #ff4d6d; color: white; border: none; border-radius: 50px; cursor: pointer; font-size: 1rem; }
        .s2_btn_run { padding: 10px 30px; background: #666; color: white; border: none; border-radius: 50px; cursor: pointer; font-size: 1rem; position: absolute; transition: 0.1s; }

        /* =========================================
           SCENE 3 STYLE: çœŸå¿ƒè©±æ¸¬è©¦
           ========================================= */
        .s3_card { background: rgba(255,255,255,0.1); padding: 40px; border-radius: 20px; backdrop-filter: blur(10px); text-align: center; border: 1px solid rgba(255,255,255,0.2); z-index: 10; width: 300px; }
        .s3_btn { padding: 10px 20px; margin: 10px; border-radius: 10px; border: none; cursor: pointer; font-size: 1rem; transition: 0.3s; }
        .s3_bad { background: #444; color: #fff; }
        .s3_good { background: #ff4d6d; color: #fff; }

        /* =========================================
           SCENE 4 STYLE: ç…§ç‰‡å›æ†¶æµ
           ========================================= */
        .s4_container { width: 90%; max-width: 500px; text-align: center; z-index: 10; }
        .s4_photo_frame { 
            width: 100%; height: 350px; background: #000; border: 2px solid #fff; 
            display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 20px;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }
        .s4_img { max-width: 100%; max-height: 100%; object-fit: contain; animation: fadeIn 1s ease; }
        .s4_caption { font-size: 1.2rem; margin-bottom: 20px; min-height: 30px; text-shadow: 1px 1px 5px #000; }
        .s4_btn { padding: 10px 30px; background: rgba(255,255,255,0.2); border: 1px solid #fff; color: #fff; cursor: pointer; border-radius: 30px; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* =========================================
           SCENE 5 STYLE: è›‹ç³•èˆ‡è¨±é¡˜
           ========================================= */
        .s5_container { text-align: center; z-index: 10; }
        .s5_cake_box { position: relative; width: 200px; height: 200px; margin: 0 auto; }
        /* ç°¡æ˜“ç²¾ç·»è›‹ç³• CSS */
        .s5_cake_base { position: absolute; bottom: 20px; left: 25px; width: 150px; height: 60px; background: #f5c096; border-radius: 10px; }
        .s5_cake_top { position: absolute; bottom: 80px; left: 25px; width: 150px; height: 50px; background: #ffbcd9; border-radius: 15px 15px 5px 5px; }
        .s5_candle { position: absolute; bottom: 130px; left: 95px; width: 10px; height: 40px; background: #fff; z-index: 2; }
        .s5_flame { 
            position: absolute; top: -20px; left: -2px; width: 14px; height: 20px; background: #ffcc00; 
            border-radius: 50% 50% 20% 20%; animation: flicker 0.5s infinite alternate; display: none; 
            box-shadow: 0 0 20px #ff6600;
        }
        .s5_btn { margin-top: 30px; padding: 12px 30px; background: #ff4d6d; color: white; border: none; border-radius: 50px; cursor: pointer; font-size: 1.2rem; font-weight: bold; }
        @keyframes flicker { from { opacity: 0.8; transform: scale(1); } to { opacity: 1; transform: scale(1.1); } }

        /* =========================================
           SCENE 6 STYLE: ä¿¡å°èˆ‡çµå°¾
           ========================================= */
        .s6_envelope { 
            width: 300px; height: 200px; background: #ff758c; position: relative; margin: 0 auto;
            cursor: pointer; transform: scale(0); transition: transform 1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 20; border-radius: 5px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .s6_flap { position: absolute; top: 0; left: 0; border-left: 150px solid transparent; border-right: 150px solid transparent; border-top: 110px solid #ff9a9e; transform-origin: top; transition: 0.6s; }
        .s6_letter {
            position: absolute; top: 10px; left: 15px; width: 270px; height: 300px; background: #fff; color: #333;
            padding: 20px; box-sizing: border-box; font-size: 1rem; line-height: 1.6; border-radius: 5px;
            transform: translateY(0); transition: 1s; opacity: 0; text-align: left;
        }
        /* é–‹ä¿¡å‹•ç•« */
        .s6_open .s6_flap { transform: rotateX(180deg); }
        .s6_open .s6_letter { transform: translateY(-150px); opacity: 1; z-index: 50; }
    </style>
</head>
<body>

    <div id="fireworks-canvas"></div>
    <video muted loop playsinline id="bg-video"><source src="bgvideo.mp4" type="video/mp4"></video>
    
    <audio id="sfx-login"><source src="sfx_login.mp3" type="audio/mpeg"></audio>
    <audio id="bgm-login" loop><source src="bg_login.mp3" type="audio/mpeg"></audio>
    <audio id="bgm-memory" loop><source src="bg_memory.mp3" type="audio/mpeg"></audio>
    <audio id="bgm-party" loop><source src="bg_party.mp3" type="audio/mpeg"></audio>

    <div id="scene-1" class="scene-container active">
        <div class="s1_terminal" id="s1-terminal">
            <div class="s1_text" id="s1-msg"></div>
            
            <div id="s1-input-area">
                <input type="password" id="s1-input" class="s1_input" placeholder="****">
                <button class="s1_btn" onclick="s1_login()">[ ACCESS SYSTEM ]</button>
            </div>

            <div id="s1-loading" class="s1_loading_container">
                <div id="s1-loading-msg" style="color:#0f0;">LOGIN SUCCESSFUL...</div>
                <div class="s1_loading_bar_bg">
                    <div id="s1-bar-fill" class="s1_loading_bar_fill"></div>
                </div>
                <div class="s1_status">LOADING: <span id="s1-percent">0</span>%</div>
                <div id="s1-log" style="font-size: 0.7rem; color: #0f0; margin-top: 10px; text-align: left; opacity: 0.7;"></div>
            </div>
        </div>
    </div>

    <div id="scene-2" class="scene-container">
        <div class="s2_card">
            <h2>âš ï¸ å®‰å…¨æ€§é©—è­‰ I</h2>
            <p>æº–å‚™å¥½é€²å…¥ 21 æ­²å‰¯æœ¬äº†å—ï¼Ÿ</p>
            <div style="height: 100px; position: relative; margin-top: 30px;">
                <button class="s2_btn_ok" onclick="gotoScene(3)">æº–å‚™å¥½äº†ï¼</button>
                <button id="s2-run-btn" class="s2_btn_run" onmouseover="s2_runAway()" onclick="s2_runAway()" style="top:0; left: 60%;">é‚„æ²’...</button>
            </div>
        </div>
    </div>

    <div id="scene-3" class="scene-container">
        <div class="s3_card">
            <h2>âš ï¸ å®‰å…¨æ€§é©—è­‰ II</h2>
            <p>è£½ä½œé€™å€‹ç¶²é çš„äººæŠ€è¡“å¦‚ä½•ï¼Ÿ</p>
            <div style="margin-top: 30px;">
                <button class="s3_btn s3_bad" onclick="s3_check(false)">æ ¹æœ¬èœé›</button>
                <button class="s3_btn s3_good" onclick="s3_check(true)">ç¥ç´šæ“ä½œ</button>
            </div>
        </div>
    </div>

    <div id="scene-4" class="scene-container">
        <div class="s4_container">
            <h3 id="s4-counter">Loading Memories...</h3>
            <div class="s4_photo_frame">
                <img id="s4-img" class="s4_img" src="" alt="Memory">
            </div>
            <div id="s4-caption" class="s4_caption"></div>
            <button class="s4_btn" onclick="s4_next()">ä¸‹ä¸€å¼µ</button>
        </div>
    </div>

    <div id="scene-5" class="scene-container">
        <div class="s5_container">
            <h1>Level 21 Unlocked!</h1>
            <div class="s5_cake_box">
                <div class="s5_cake_base"></div>
                <div class="s5_cake_top"></div>
                <div class="s5_candle"><div id="s5-flame" class="s5_flame"></div></div>
            </div>
            
            <button id="s5-btn-light" class="s5_btn" onclick="s5_lightUp()">é»ç‡ƒè–ç«</button>
            
            <button id="s5-btn-next" class="s5_btn" style="display: none; background: #888;" onclick="s5_finish()">ğŸ é ˜å–æ‰è½ç‰©</button>
            </div>
    </div>

    <div id="scene-6" class="scene-container">
        <div id="s6-envelope" class="s6_envelope" onclick="s6_open()">
            <div class="s6_flap"></div>
            <div class="s6_letter" id="s6-content">
                </div>
        </div>
        <h2 style="margin-top: 250px;">ğŸ‘‡ é»æ“Šé–‹å•Ÿæ‰è½ç‰©</h2>
    </div>

    <script>
        // =========================================
        // CONFIG: è«‹åœ¨é€™è£¡ä¿®æ”¹ä½ çš„å…§å®¹
        // =========================================
        const CONFIG = {
            targetName: "å¤¥ä¼´",  // å¥¹çš„åå­—
            password: "0121",
            
            // ç¬¬å››å¹•ï¼šç…§ç‰‡æ¸…å–® (è«‹ä¸Šå‚³å°æ‡‰ç…§ç‰‡)
            photos: [
                { src: "photo1.jpg", text: "é€™æ˜¯æˆ‘å€‘ç¬¬ä¸€æ¬¡çµ„éšŠ..." },
                { src: "photo2.jpg", text: "é‚£æ™‚å€™å¦³é‚„åœ¨é›·..." },
                { src: "photo3.jpg", text: "çµ‚æ–¼è´äº†ä¸€å ´ï¼" }
            ],
            
            // ç¬¬å…­å¹•ï¼šæœ€å¾Œçš„ä¿¡
            finalLetter: `
                <h3>Happy Birthday!</h3>
                <p>é€™æ˜¯ä¸€å°è—åœ¨ç¨‹å¼ç¢¼å¾Œçš„ä¿¡ã€‚<br>
                é›–ç„¶åªæ˜¯ç°¡å–®çš„ç¶²é ï¼Œ<br>
                ä½†åŒ…å«äº†æˆ‘å€‘é€™ä¸€å¹´æ»¿æ»¿çš„å›æ†¶ã€‚<br>
                ç¥å¦³å‡ç´šå¿«æ¨‚ï¼Œç¹¼çºŒ Carry æˆ‘ï¼</p>
            `
        };

        // åˆå§‹åŒ–ç…™ç«
        const fireworks = new Fireworks.default(document.querySelector('#fireworks-canvas'));

        // é€šç”¨ï¼šåˆ‡æ›å ´æ™¯å‡½å¼
        function gotoScene(n) {
            document.querySelectorAll('.scene-container').forEach(el => el.classList.remove('active'));
            document.getElementById(`scene-${n}`).classList.add('active');
            
            // éŸ³æ¨‚è‡ªå‹•åˆ‡æ›é‚è¼¯
            if(n === 4) switchMusic('bgm-memory');
            if(n === 5) switchMusic('bgm-party');
        }

        function switchMusic(id) {
            document.querySelectorAll('audio').forEach(a => { a.pause(); a.currentTime = 0; });
            document.getElementById(id).play().catch(()=>{});
        }

        // =========================================
        // SCENE 1 LOGIC: çµ‚ç«¯æ©Ÿ
        // =========================================

        window.onload = function() {
            // é€™è£¡ä¿®æ”¹é–‹å ´çš„ç³»çµ±æ–‡å­—
            const msg = `> ç³»çµ±åµæ¸¬å•Ÿå‹•...\n> ç©å®¶ ID: [${CONFIG.targetName}]\n> ç™¼ç¾ç”Ÿæ—¥æ•¸æ“šæµï¼Œæ­£åœ¨è§£æ...\n> è«‹æ±‚å­˜å–æ¬Šé™..._`;
            const el = document.getElementById('s1-msg');
            let i = 0;
            function type() { 
                if(i < msg.length) { 
                    el.innerHTML = msg.substring(0, i+1).replace(/\n/g, "<br>"); 
                    i++; setTimeout(type, 50); 
                }
            }
            type();
        };

        // 2. ç™»å…¥æª¢æŸ¥ (ä¸­æ–‡éŒ¯èª¤è¨Šæ¯)
        function s1_login() {
            const inputVal = document.getElementById('s1-input').value;
            if(inputVal === CONFIG.password) {
                document.getElementById('sfx-login').play().catch(()=>{});
                document.getElementById('s1-input-area').style.display = 'none';
                document.getElementById('s1-loading').style.display = 'block';
                s1_startLoading();
            } else {
                // é€™è£¡ä¿®æ”¹éŒ¯èª¤è¨Šæ¯
                alert("æ‹’çµ•å­˜å–ï¼šå¯†ç¢¼éŒ¯èª¤ (æç¤ºï¼šç”Ÿæ—¥)");
                document.getElementById('s1-input').value = "";
            }
        }

        // 3. é€²åº¦æ¢è·‘å‹• (ä¸­æ–‡ç³»çµ±ç´€éŒ„)
        function s1_startLoading() {
            let percent = 0;
            const bar = document.getElementById('s1-bar-fill');
            const percentText = document.getElementById('s1-percent');
            const logText = document.getElementById('s1-log');
            
            // é€™è£¡ä¿®æ”¹è·‘æ¢æ™‚è·³å‡ºçš„ç³»çµ±è¨Šæ¯
            const logs = [
                "æ­£åœ¨åˆå§‹åŒ–æ ¸å¿ƒæ¨¡çµ„...",
                "åŒæ­¥ç”Ÿæ—¥å›æ†¶æ•¸æ“š...",
                "è¼‰å…¥éŠæˆ²è³‡æºåŒ…...",
                "æ­£åœ¨ç¹éå®‰å…¨é˜²ç«ç‰†...",
                "é€£ç·šè‡³ [æ¥Šé›…ç¾½] å°ˆå±¬ä¼ºæœå™¨...",
                "ç’°å¢ƒå»ºç½®å®Œæˆ..."
            ];

            const timer = setInterval(() => {
                percent += Math.floor(Math.random() * 3) + 1;
                if (percent >= 100) {
                    percent = 100;
                    clearInterval(timer);
                    
                    // é€™è£¡ä¿®æ”¹è·‘å®Œå¾Œçš„æ–‡å­—
                    document.getElementById('s1-loading-msg').innerText = "æº–å‚™é€²å…¥éŠæˆ²...";
                    setTimeout(() => {
                        const vid = document.getElementById('bg-video'); vid.play(); vid.style.opacity = 1;
                        switchMusic('bgm-login');
                        gotoScene(2);
                    }, 1000);
                }
                
                bar.style.width = percent + "%";
                percentText.innerText = percent;
                
                if (percent % 15 === 0) {
                    logText.innerText = "> " + logs[Math.floor(Math.random() * logs.length)];
                }
            }, 50);
        }
        // =========================================
        // SCENE 2 LOGIC: èµ°ä½æŒ‰éˆ•
        // =========================================
        function s2_runAway() {
            const btn = document.getElementById('s2-run-btn');
            const x = Math.random() * 200 - 100;
            const y = Math.random() * 150 - 50;
            btn.style.transform = `translate(${x}px, ${y}px)`;
            btn.innerText = "æŠ“ä¸åˆ°~";
        }

        // =========================================
        // SCENE 3 LOGIC: èª å¯¦æ¸¬è©¦
        // =========================================
        function s3_check(isGood) {
            if(isGood) {
                alert("é©—è­‰é€šéï¼é€²å…¥å›æ†¶è³‡æ–™åº«...");
                s4_load(0); // é å…ˆè¼‰å…¥ç¬¬ä¸€å¼µç…§ç‰‡
                gotoScene(4);
            } else {
                alert("âš ï¸ ç³»çµ±éŒ¯èª¤ï¼è«‹æ‘¸è‘—è‰¯å¿ƒé‡é¸ï¼");
            }
        }

        // =========================================
        // SCENE 4 LOGIC: ç…§ç‰‡æµ
        // =========================================
        let photoIndex = 0;
        function s4_load(i) {
            if(i >= CONFIG.photos.length) { gotoScene(5); return; }
            const p = CONFIG.photos[i];
            document.getElementById('s4-img').src = p.src;
            document.getElementById('s4-caption').innerText = p.text;
            document.getElementById('s4-counter').innerText = `Memory ${i+1}/${CONFIG.photos.length}`;
            photoIndex = i;
        }
        function s4_next() { s4_load(photoIndex + 1); }
// =========================================
        // SCENE 5 LOGIC: è›‹ç³• (å·²ä¿®æ”¹ï¼š20ç§’å»¶é²)
        // =========================================
        function s5_lightUp() {
            // 1. é»ç«èˆ‡ç…™ç«
            document.getElementById('s5-flame').style.display = "block";
            fireworks.start();
            
            // 2. éš±è—åŸæœ¬çš„é»ç«æŒ‰éˆ•
            document.getElementById('s5-btn-light').style.display = 'none';

            // 3. è¨­å®š 20 ç§’å€’æ•¸ï¼Œä¹‹å¾Œé¡¯ç¤ºé ˜çæŒ‰éˆ•
            // ğŸ’¡ æ¸¬è©¦æ™‚å¦‚æœä¸æƒ³è¦ç­‰20ç§’ï¼Œå¯ä»¥æŠŠä¸‹é¢çš„ 20000 æ”¹æˆ 3000 (3ç§’)
            setTimeout(() => {
                const nextBtn = document.getElementById('s5-btn-next');
                nextBtn.style.display = 'inline-block'; // é¡¯ç¤ºæŒ‰éˆ•
            }, 20000); // 20000 æ¯«ç§’ = 20 ç§’
        }

        // æ–°å¢ï¼šé»æ“Šé ˜çæŒ‰éˆ•å¾Œæ‰å»ä¸‹ä¸€å¹•
        function s5_finish() {
            gotoScene(6);
            // è®“ä¿¡å°é£›å…¥çš„å‹•ç•«
            setTimeout(() => { 
                document.getElementById('s6-envelope').style.transform = "scale(1)"; 
            }, 500);
        }
        // =========================================
        // SCENE 6 LOGIC: ä¿¡å°
        // =========================================
        document.getElementById('s6-content').innerHTML = CONFIG.finalLetter;
        function s6_open() {
            document.getElementById('s6-envelope').classList.add('s6_open');
        }

    </script>
</body>
</html>

