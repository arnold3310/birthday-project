<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday!</title>
    <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2.10.7/dist/index.umd.js"></script>
    <style>
        :root { --accent: #ff4d6d; --cream: #fff5e1; --cake-base: #f5c096; --plate: #f0f0f0; }
        body {
            margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh;
            font-family: 'Microsoft JhengHei', sans-serif; color: #fff; overflow: hidden; background: transparent;
        }

        /* --- ä¿®æ­£å¾Œçš„èƒŒæ™¯å½±ç‰‡ï¼šå¼·åˆ¶å…¨è¢å¹• --- */
        #bg-video {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            object-fit: cover; /* é—œéµï¼šè£åˆ‡å¤šé¤˜é‚Šç·£ï¼Œä¿æŒæ»¿ç‰ˆ */
            z-index: -1;
            filter: brightness(0.5); /* ç¨å¾®èª¿æš—ï¼Œå‡¸é¡¯å‰æ™¯ */
        }

        .fireworks-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 999; pointer-events: none; }
        
        .card {
            text-align: center; background: rgba(20, 30, 50, 0.75); padding: 40px; border-radius: 20px;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5); width: 85%; max-width: 450px; position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2); z-index: 10; transition: background 1s ease;
        }
        
        .hidden { display: none; }
        input { padding: 12px; border-radius: 10px; border: none; width: 70%; margin-bottom: 15px; text-align: center; font-size: 1.2rem; outline: none; background: rgba(255,255,255,0.9); color: #333; }
        .btn { padding: 12px 25px; border-radius: 50px; border: none; background: var(--accent); color: white; cursor: pointer; font-size: 1rem; transition: 0.3s; margin: 5px; font-weight: bold; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 77, 109, 0.5); }
        #typing-text { font-size: 1.2rem; line-height: 1.8; margin-bottom: 20px; text-align: left; min-height: 120px; }

        /* ====================
           ğŸ° è±ªè¯ç‰ˆè›‹ç³• CSS
           ==================== */
        .cake-stage { position: relative; height: 220px; width: 250px; margin: 0 auto 20px auto; }
        .cake-part { position: absolute; opacity: 0; left: 50%; transform: translateX(-50%); }

        /* ç›¤å­ */
        #plate { bottom: 0; width: 240px; height: 15px; background: var(--plate); border-radius: 50%; box-shadow: 0 5px 10px rgba(0,0,0,0.3); }
        /* è›‹ç³•åº•å±¤ */
        #cake-bottom { bottom: 15px; width: 200px; height: 70px; background: var(--cake-base); border-radius: 10px 10px 5px 5px; box-shadow: inset -10px 0 20px rgba(0,0,0,0.1); }
        /* è›‹ç³•ä¸­å±¤ */
        #cake-middle { bottom: 80px; width: 200px; height: 10px; background: #7a4b36; border-radius: 2px; }
        /* è›‹ç³•é ‚å±¤ */
        #cake-top { bottom: 85px; width: 200px; height: 60px; background: #ffbcd9; border-radius: 15px 15px 5px 5px; box-shadow: inset -5px -5px 10px rgba(0,0,0,0.05); z-index: 2; }
        #cake-top::before { content: ''; position: absolute; top: 50px; left: 15px; width: 20px; height: 25px; background: #ffbcd9; border-radius: 0 0 20px 20px; box-shadow: 40px 0 0 #ffbcd9, 80px 5px 0 #ffbcd9, 120px 0 0 #ffbcd9, 150px 8px 0 #ffbcd9; }
        /* æ«»æ¡ƒ */
        .cherry { width: 20px; height: 20px; background: #d90429; border-radius: 50%; position: absolute; top: -10px; z-index: 3; box-shadow: inset -2px -2px 5px rgba(0,0,0,0.3); }
        /* è Ÿç‡­ */
        #candle { bottom: 140px; width: 12px; height: 40px; background: repeating-linear-gradient(45deg, #fff, #fff 4px, #74c0fc 4px, #74c0fc 8px); z-index: 1; border-radius: 2px; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); }
        #flame { width: 14px; height: 24px; background: #ffcc00; border-radius: 50% 50% 20% 20%; position: absolute; top: -25px; left: 50%; transform: translateX(-50%); box-shadow: 0 0 15px #ff6600, 0 0 30px #ffcc00; animation: flicker 0.4s infinite alternate; display: none; }

        /* å‹•ç•«å€ */
        @keyframes bounceInUp { 0% { opacity: 0; transform: translate(-50%, 100px); } 60% { opacity: 1; transform: translate(-50%, -10px); } 100% { opacity: 1; transform: translate(-50%, 0); } }
        @keyframes dropDown { 0% { opacity: 0; transform: translate(-50%, -100px); } 60% { opacity: 1; transform: translate(-50%, 10px); } 100% { opacity: 1; transform: translate(-50%, 0); } }
        @keyframes flicker { from { opacity: 0.85; transform: translateX(-50%) scale(0.9); } to { opacity: 1; transform: translateX(-50%) scale(1.1); } }

        .animate #plate { animation: bounceInUp 0.8s ease-out forwards; }
        .animate #cake-bottom { animation: bounceInUp 0.8s ease-out 0.3s forwards; }
        .animate #cake-middle { animation: bounceInUp 0.8s ease-out 0.5s forwards; }
        .animate #cake-top { animation: dropDown 0.8s ease-out 0.8s forwards; }
        .animate .cherry { animation: dropDown 0.6s ease-out 1.2s forwards; }
        .animate #candle { animation: dropDown 0.6s ease-out 1.4s forwards; }
    </style>
</head>
<body>

    <div class="fireworks-container"></div>
    
    <video autoplay muted loop playsinline id="bg-video">
        <source src="bgvideo.mp4" type="video/mp4">
    </video>
    
    <audio id="bgMusic" loop>
        <source src="bgsong.mp3" type="audio/mpeg">
    </audio>

    <div id="step1" class="card">
        <h2>ğŸ”’ èº«åˆ†é©—è­‰</h2>
        <p>è«‹è¼¸å…¥å°ˆå±¬å¯†ç¢¼</p>
        <input type="password" id="pw-input">
        <br><button class="btn" onclick="checkPassword()">è§£é–é©šå–œ</button>
    </div>

    <div id="step2" class="card hidden">
        <h2>æˆ‘æƒ³å°å¦³èªª...</h2>
        <div id="typing-text"></div>
        <button id="next-btn" class="btn hidden" onclick="showInteractions()">ä¸‹ä¸€æ­¥</button>
    </div>

    <div id="step3" class="card hidden">
        <h1 id="final-title">Happy Birthday!</h1>
        
        <div class="cake-stage" id="cake-stage">
            <div id="plate" class="cake-part"></div>
            <div id="cake-bottom" class="cake-part"></div>
            <div id="cake-middle" class="cake-part"></div>
            <div id="cake-top" class="cake-part">
                <div class="cherry" style="left: 20px;"></div>
                <div class="cherry" style="left: 90px;"></div>
                <div class="cherry" style="left: 160px;"></div>
            </div>
            <div id="candle" class="cake-part"><div id="flame"></div></div>
        </div>

        <div id="display-area" style="margin: 10px 0; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.8);">ç¥å¦³æ–°çš„ä¸€æ­²å¤©å¤©é–‹å¿ƒï¼âœ¨</div>
        <button class="btn" id="final-btn" onclick="finalSurprise()">é»ç‡ƒé©šå–œ</button>
    </div>

    <script>
        const correctPw = '0121'; // å¯†ç¢¼è¨­å®š
        const heartWords = "é›–ç„¶æˆ‘å€‘é‚„æ²’çœŸæ­£è¦‹éé¢ï¼Œ\nä½†é€™æ®µæ™‚é–“å’Œå¦³èŠå¤©çœŸçš„å¾ˆé–‹å¿ƒã€‚\nåœ¨é€™å€‹ç‰¹åˆ¥çš„æ—¥å­ï¼Œ\næƒ³ç”¨æˆ‘æ­£åœ¨å­¸çš„ç¨‹å¼ï¼Œçµ¦å¦³ä¸€é»ä¸ä¸€æ¨£çš„ç¥ç¦...";
        
        const fireworks = new Fireworks.default(document.querySelector('.fireworks-container'), { intensity: 30, particles: 150 });

        function checkPassword() {
            if (document.getElementById('pw-input').value === correctPw) {
                // å˜—è©¦æ’­æ”¾éŸ³æ¨‚
                document.getElementById('bgMusic').play().catch(() => { console.log("éŸ³æ¨‚è‡ªå‹•æ’­æ”¾éœ€äº’å‹•"); });
                
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
                startTyping();
            } else { alert("å¯†ç¢¼éŒ¯èª¤å–”ï¼"); }
        }

        function startTyping(){
            const area=document.getElementById('typing-text'); let i=0;
            function type(){
                if(i<heartWords.length){
                    area.innerHTML+=heartWords.charAt(i)==='\n'?'<br>':heartWords.charAt(i);
                    i++; setTimeout(type, 100);
                }else{ document.getElementById('next-btn').classList.remove('hidden'); }
            } type();
        }

        function showInteractions(){
            document.getElementById('step2').classList.add('hidden');
            document.getElementById('step3').classList.remove('hidden');
        }

        function finalSurprise() {
            document.getElementById('final-title').innerText = "ğŸ‚ ç”Ÿæ—¥å¿«æ¨‚ï¼ğŸ‚";
            document.getElementById('final-btn').style.display = 'none';
            document.getElementById('cake-stage').classList.add('animate');
            // 2ç§’å¾Œé»ç«ä¸¦æ”¾ç…™ç«
            setTimeout(() => {
                document.getElementById('flame').style.display = 'block';
                fireworks.start();
                document.querySelector('#step3.card').style.background = 'rgba(20, 30, 50, 0.4)';
            }, 2000);
        }
    </script>
</body>
</html>
