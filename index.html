<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy 21st Birthday!</title>
    <script src="https://cdn.jsdelivr.net/npm/fireworks-js@2.10.7/dist/index.umd.js"></script>
    <style>
        :root { --accent: #ff4d6d; --cream: #fff5e1; --cake-base: #f5c096; --plate: #f0f0f0; }
        body {
            margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh;
            font-family: 'Microsoft JhengHei', sans-serif; color: #fff; overflow: hidden; background: #000;
        }

        /* èƒŒæ™¯å½±ç‰‡è¨­å®š */
        #bg-video {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            object-fit: cover; z-index: -1;
            filter: brightness(0.5); opacity: 0; transition: opacity 2.5s ease-in;
        }

        .fireworks-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 999; pointer-events: none; }
        
        /* å¡ç‰‡ä¸»é«” */
        .card {
            text-align: center; background: rgba(20, 30, 50, 0.75); padding: 40px; border-radius: 20px;
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.5); width: 85%; max-width: 450px; position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2); z-index: 10; 
            transition: all 0.8s ease; /* å¢åŠ éæ¸¡æ•ˆæœï¼Œè®“èƒŒæ™¯æ¶ˆå¤±æ›´æ»‘é † */
        }
        
        .hidden { display: none; }
        input { padding: 12px; border-radius: 10px; border: none; width: 70%; margin-bottom: 15px; text-align: center; font-size: 1.2rem; outline: none; background: rgba(255,255,255,0.9); color: #333; }
        .btn { padding: 12px 25px; border-radius: 50px; border: none; background: var(--accent); color: white; cursor: pointer; font-size: 1rem; transition: 0.3s; margin: 5px; font-weight: bold; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 77, 109, 0.5); }
        #typing-text { font-size: 1.2rem; line-height: 1.8; margin-bottom: 20px; text-align: left; min-height: 120px; }

        /* è›‹ç³•æ¨£å¼ */
        .cake-stage { position: relative; height: 220px; width: 250px; margin: 0 auto 20px auto; }
        .cake-part { position: absolute; opacity: 0; left: 50%; transform: translateX(-50%); }
        #plate { bottom: 0; width: 240px; height: 15px; background: var(--plate); border-radius: 50%; box-shadow: 0 5px 10px rgba(0,0,0,0.3); }
        #cake-bottom { bottom: 15px; width: 200px; height: 70px; background: var(--cake-base); border-radius: 10px 10px 5px 5px; box-shadow: inset -10px 0 20px rgba(0,0,0,0.1); }
        #cake-middle { bottom: 80px; width: 200px; height: 10px; background: #7a4b36; border-radius: 2px; }
        #cake-top { bottom: 85px; width: 200px; height: 60px; background: #ffbcd9; border-radius: 15px 15px 5px 5px; box-shadow: inset -5px -5px 10px rgba(0,0,0,0.05); z-index: 2; }
        #cake-top::before { content: ''; position: absolute; top: 50px; left: 15px; width: 20px; height: 25px; background: #ffbcd9; border-radius: 0 0 20px 20px; box-shadow: 40px 0 0 #ffbcd9, 80px 5px 0 #ffbcd9, 120px 0 0 #ffbcd9, 150px 8px 0 #ffbcd9; }
        .cherry { width: 20px; height: 20px; background: #d90429; border-radius: 50%; position: absolute; top: -10px; z-index: 3; box-shadow: inset -2px -2px 5px rgba(0,0,0,0.3); }
        #candle { bottom: 140px; width: 12px; height: 40px; background: repeating-linear-gradient(45deg, #fff, #fff 4px, #74c0fc 4px, #74c0fc 8px); z-index: 1; border-radius: 2px; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); }
        #flame { width: 14px; height: 24px; background: #ffcc00; border-radius: 50% 50% 20% 20%; position: absolute; top: -25px; left: 50%; transform: translateX(-50%); box-shadow: 0 0 15px #ff6600, 0 0 30px #ffcc00; animation: flicker 0.4s infinite alternate; display: none; }

        /* æ–°å¢ï¼š21æ­²ç¥ç¦èªæ¨£å¼ */
        #post-cake-wishes { font-size: 1.3rem; font-weight: bold; line-height: 1.8; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); margin-top: 30px; opacity: 0; /* åˆå§‹éš±è— */ }
        .highlight-21 { font-size: 2.5rem; color: #ff4d6d; vertical-align: middle; margin: 0 5px; }

        /* å‹•ç•«å®šç¾© */
        @keyframes bounceInUp { 0% { opacity: 0; transform: translate(-50%, 100px); } 60% { opacity: 1; transform: translate(-50%, -10px); } 100% { opacity: 1; transform: translate(-50%, 0); } }
        @keyframes dropDown { 0% { opacity: 0; transform: translate(-50%, -100px); } 60% { opacity: 1; transform: translate(-50%, 10px); } 100% { opacity: 1; transform: translate(-50%, 0); } }
        @keyframes flicker { from { opacity: 0.85; transform: translateX(-50%) scale(0.9); } to { opacity: 1; transform: translateX(-50%) scale(1.1); } }
        @keyframes fadeInText { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* å‹•ç•«é¡åˆ¥ */
        .animate #plate { animation: bounceInUp 0.8s ease-out forwards; }
        .animate #cake-bottom { animation: bounceInUp 0.8s ease-out 0.3s forwards; }
        .animate #cake-middle { animation: bounceInUp 0.8s ease-out 0.5s forwards; }
        .animate #cake-top { animation: dropDown 0.8s ease-out 0.8s forwards; }
        .animate .cherry { animation: dropDown 0.6s ease-out 1.2s forwards; }
        .animate #candle { animation: dropDown 0.6s ease-out 1.4s forwards; }
        .fade-in { animation: fadeInText 1.5s ease-out forwards; } /* æ–‡å­—æ·¡å…¥å‹•ç•« */
    </style>
</head>
<body>

    <div class="fireworks-container"></div>
    <video muted loop playsinline id="bg-video"><source src="bgvideo.mp4" type="video/mp4"></video>
    <audio id="introMusic" loop><source src="bg2song.mp3" type="audio/mpeg"></audio>
    <audio id="cakeMusic" loop><source src="bgsong.mp3" type="audio/mpeg"></audio>

    <div id="step1" class="card">
        <h2>ğŸ”’ èº«åˆ†é©—è­‰</h2>
        <p>è«‹è¼¸å…¥å°ˆå±¬å¯†ç¢¼</p>
        <input type="password" id="pw-input">
        <br><button class="btn" onclick="checkPassword()">è§£é–é©šå–œ</button>
    </div>

    <div id="step2" class="card hidden">
        <h2>æˆ‘æƒ³å°å¦³èªª...</h2>
        <div id="typing-text"></div>
        <button id="next-btn" class="btn hidden" onclick="showInteractions()">ä¸‹ä¸€æ­¥</button>
    </div>

    <div id="step3" class="card hidden">
        <div id="pre-cake-elements">
            <h1 style="margin-bottom: 30px;">æº–å‚™å¥½äº†å—ï¼Ÿ</h1>
            <button class="btn" id="final-btn" onclick="finalSurprise()">é»ç‡ƒé©šå–œ</button>
        </div>

        <div class="cake-stage" id="cake-stage">
            <div id="plate" class="cake-part"></div>
            <div id="cake-bottom" class="cake-part"></div>
            <div id="cake-middle" class="cake-part"></div>
            <div id="cake-top" class="cake-part">
                <div class="cherry" style="left: 20px;"></div>
                <div class="cherry" style="left: 90px;"></div>
                <div class="cherry" style="left: 160px;"></div>
            </div>
            <div id="candle" class="cake-part"><div id="flame"></div></div>
        </div>

        <div id="post-cake-wishes">
            Happy <span class="highlight-21">21</span> Birthday!<br>
            é€™æ˜¯æœ€ç¾å¥½çš„å¹´ç´€ï¼Œé¡˜å¦³é–ƒé–ƒç™¼å…‰âœ¨<br>
            æœªä¾†çš„ä¸€åˆ‡éƒ½å¦‚å¦³æ‰€é¡˜ï¼
        </div>
    </div>

    <script>
        const correctPw = '0121';
        // é€™è£¡å¯ä»¥ä¿®æ”¹ç¬¬äºŒé çš„çœŸå¿ƒè©±
        const heartWords = "é›–ç„¶æˆ‘å€‘é‚„æ²’çœŸæ­£è¦‹éé¢ï¼Œ\nä½†é€™æ®µæ™‚é–“å’Œå¦³èŠå¤©çœŸçš„å¾ˆé–‹å¿ƒã€‚\nåœ¨é€™å€‹ç‰¹åˆ¥çš„æ—¥å­ï¼Œ\næƒ³ç”¨æˆ‘æ­£åœ¨å­¸çš„ç¨‹å¼ï¼Œçµ¦å¦³ä¸€é»ä¸ä¸€æ¨£çš„ç¥ç¦...";
        
        const fireworks = new Fireworks.default(document.querySelector('.fireworks-container'), { intensity: 30, particles: 150 });

        function checkPassword() {
            if (document.getElementById('pw-input').value === correctPw) {
                const video = document.getElementById('bg-video'); video.play(); video.style.opacity = 1;
                document.getElementById('introMusic').play().catch(() => {});
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
                startTyping();
            } else { alert("å¯†ç¢¼éŒ¯èª¤å–”ï¼"); }
        }

        function startTyping(){
            const area=document.getElementById('typing-text'); let i=0;
            function type(){ if(i<heartWords.length){ area.innerHTML+=heartWords.charAt(i)==='\n'?'<br>':heartWords.charAt(i); i++; setTimeout(type, 100); }else{ document.getElementById('next-btn').classList.remove('hidden'); } } type();
        }

        function showInteractions(){ document.getElementById('step2').classList.add('hidden'); document.getElementById('step3').classList.remove('hidden'); }

        function finalSurprise() {
            // 1. åˆ‡æ›éŸ³æ¨‚
            const intro = document.getElementById('introMusic'); intro.pause(); intro.currentTime = 0;
            document.getElementById('cakeMusic').play();

            // 2. --- é—œéµä¿®æ”¹ï¼šç«‹åˆ»éš±è—èˆŠæ–‡å­—èˆ‡æŒ‰éˆ• ---
            document.getElementById('pre-cake-elements').style.display = 'none';

            // 3. --- é—œéµä¿®æ”¹ï¼šç§»é™¤æ·±è‰²å¡ç‰‡èƒŒæ™¯ ---
            // è®“èƒŒæ™¯è®Šé€æ˜ï¼Œä¸¦ç§»é™¤é‚Šæ¡†å’Œé™°å½±ï¼Œè®“è›‹ç³•æ‡¸æµ®åœ¨å¤œæ™¯ä¸­
            const card = document.querySelector('#step3.card');
            card.style.background = 'transparent';
            card.style.boxShadow = 'none';
            card.style.border = 'none';
            card.style.backdropFilter = 'none'; // ç§»é™¤æ¯›ç»ç’ƒæ•ˆæœ

            // 4. å•Ÿå‹•è›‹ç³•å‹•ç•«
            document.getElementById('cake-stage').classList.add('animate');
            
            // 5. å»¶é²å¾Œé»ç«ã€æ”¾ç…™ç«ã€é¡¯ç¤º 21 æ­²ç¥ç¦
            setTimeout(() => {
                document.getElementById('flame').style.display = 'block';
                fireworks.start();
                // é¡¯ç¤ºæ–°çš„ç¥ç¦èªä¸¦åŠ ä¸Šæ·¡å…¥å‹•ç•«
                document.getElementById('post-cake-wishes').classList.add('fade-in');
            }, 2000);
        }
    </script>
</body>
</html>
